{"version":3,"file":"static/js/1705.9364dbac.chunk.js","mappings":"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","sources":["screens/Console/Buckets/BucketDetails/SummaryItems/BucketTags.tsx","../node_modules/@mui/icons-material/Add.js"],"sourcesContent":["// This file is part of MinIO Console Server\r\n// Copyright (c) 2022 MinIO, Inc.\r\n//\r\n// This program is free software: you can redistribute it and/or modify\r\n// it under the terms of the GNU Affero General Public License as published by\r\n// the Free Software Foundation, either version 3 of the License, or\r\n// (at your option) any later version.\r\n//\r\n// This program is distributed in the hope that it will be useful,\r\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n// GNU Affero General Public License for more details.\r\n//\r\n// You should have received a copy of the GNU Affero General Public License\r\n// along with this program.  If not, see <http://www.gnu.org/licenses/>.\r\nimport React, { useEffect, useState } from \"react\";\r\nimport { Bucket } from \"../../../Watch/types\";\r\nimport { ErrorResponseHandler } from \"../../../../../common/types\";\r\nimport useApi from \"../../../Common/Hooks/useApi\";\r\nimport { Box } from \"@mui/material\";\r\nimport { IAM_SCOPES } from \"../../../../../common/SecureComponent/permissions\";\r\nimport { SecureComponent } from \"../../../../../common/SecureComponent\";\r\nimport get from \"lodash/get\";\r\nimport Chip from \"@mui/material/Chip\";\r\nimport CloseIcon from \"@mui/icons-material/Close\";\r\nimport AddIcon from \"@mui/icons-material/Add\";\r\nimport withSuspense from \"../../../Common/Components/withSuspense\";\r\nimport Loader from \"../../../Common/Loader/Loader\";\r\n\r\nimport { setErrorSnackMessage } from \"../../../../../systemSlice\";\r\nimport { useAppDispatch } from \"../../../../../store\";\r\nimport { useTranslation } from 'react-i18next';\r\n\r\n\r\nconst AddBucketTagModal = withSuspense(\r\n  React.lazy(() => import(\"../AddBucketTagModal\"))\r\n);\r\nconst DeleteBucketTagModal = withSuspense(\r\n  React.lazy(() => import(\"../DeleteBucketTagModal\"))\r\n);\r\n\r\ntype BucketTagProps = {\r\n  bucketName: string;\r\n};\r\n\r\nconst BucketTags = ({ bucketName }: BucketTagProps) => {\r\n  const dispatch = useAppDispatch();\r\n\r\n  const [tags, setTags] = useState<any>(null);\r\n  const [tagModalOpen, setTagModalOpen] = useState<boolean>(false);\r\n  const [tagKeys, setTagKeys] = useState<string[]>([]);\r\n  const [selectedTag, setSelectedTag] = useState<string[]>([\"\", \"\"]);\r\n  const [deleteTagModalOpen, setDeleteTagModalOpen] = useState<boolean>(false);\r\n\r\n  const closeAddTagModal = (refresh: boolean) => {\r\n    setTagModalOpen(false);\r\n    if (refresh) {\r\n      fetchTags();\r\n    }\r\n  };\r\n\r\n  const deleteTag = (tagKey: string, tagLabel: string) => {\r\n    setSelectedTag([tagKey, tagLabel]);\r\n    setDeleteTagModalOpen(true);\r\n  };\r\n\r\n  const closeDeleteTagModal = (refresh: boolean) => {\r\n    setDeleteTagModalOpen(false);\r\n\r\n    if (refresh) {\r\n      fetchTags();\r\n    }\r\n  };\r\n\r\n  const onTagLoaded = (res: Bucket) => {\r\n    if (res != null && res?.details != null && \"tags\" in res?.details) {\r\n      setTags(res?.details?.tags);\r\n      setTagKeys(Object.keys(res?.details?.tags));\r\n    }\r\n  };\r\n\r\n  const onTagLoadFailed = (err: ErrorResponseHandler) => {\r\n    dispatch(setErrorSnackMessage(err));\r\n  };\r\n\r\n  const [isLoading, invokeTagsApi] = useApi(onTagLoaded, onTagLoadFailed);\r\n\r\n  const fetchTags = () => {\r\n    invokeTagsApi(\"GET\", `/api/v1/buckets/${bucketName}`);\r\n  };\r\n\r\n  useEffect(() => {\r\n    fetchTags();\r\n    // eslint-disable-next-line react-hooks/exhaustive-deps\r\n  }, [bucketName]);\r\n  const { t } = useTranslation();\r\n\r\n  return (\r\n    <Box>\r\n      {isLoading ? <Loader style={{ width: 16, height: 16 }} /> : null}\r\n      <SecureComponent\r\n        scopes={[IAM_SCOPES.S3_GET_BUCKET_TAGGING]}\r\n        resource={bucketName}\r\n      >\r\n        <Box\r\n          sx={{\r\n            display: \"flex\",\r\n            flexFlow: \"column\",\r\n          }}\r\n        >\r\n          <Box>\r\n            {tagKeys &&\r\n              tagKeys.map((tagKey: any, index: any) => {\r\n                const tag = get(tags, `${tagKey}`, \"\");\r\n                if (tag !== \"\") {\r\n                  return (\r\n                    <SecureComponent\r\n                      key={`chip-${index}`}\r\n                      scopes={[IAM_SCOPES.S3_PUT_BUCKET_TAGGING]}\r\n                      resource={bucketName}\r\n                      matchAll\r\n                      errorProps={{\r\n                        deleteIcon: null,\r\n                        onDelete: null,\r\n                      }}\r\n                    >\r\n                      <Chip\r\n                        style={{\r\n                          textTransform: \"none\",\r\n                          marginRight: \"5px\",\r\n                        }}\r\n                        size=\"small\"\r\n                        label={`${tagKey} : ${tag}`}\r\n                        color=\"primary\"\r\n                        deleteIcon={<CloseIcon />}\r\n                        onDelete={() => {\r\n                          deleteTag(tagKey, tag);\r\n                        }}\r\n                      />\r\n                    </SecureComponent>\r\n                  );\r\n                }\r\n                return null;\r\n              })}\r\n          </Box>\r\n\r\n          <SecureComponent\r\n            scopes={[IAM_SCOPES.S3_PUT_BUCKET_TAGGING]}\r\n            resource={bucketName}\r\n            errorProps={{ disabled: true, onClick: null }}\r\n          >\r\n            <Chip\r\n              style={{ maxWidth: 80, marginTop: \"10px\" }}\r\n              icon={<AddIcon />}\r\n              clickable\r\n              size=\"small\"\r\n              label= {t(\"add\")+\" tags\"}\r\n              color=\"primary\"\r\n              variant=\"outlined\"\r\n              onClick={() => {\r\n                setTagModalOpen(true);\r\n              }}\r\n            />\r\n          </SecureComponent>\r\n        </Box>\r\n      </SecureComponent>\r\n\r\n      {/** Modals **/}\r\n\r\n      {tagModalOpen && (\r\n        <AddBucketTagModal\r\n          modalOpen={tagModalOpen}\r\n          currentTags={tags}\r\n          bucketName={bucketName}\r\n          onCloseAndUpdate={closeAddTagModal}\r\n        />\r\n      )}\r\n      {deleteTagModalOpen && (\r\n        <DeleteBucketTagModal\r\n          deleteOpen={deleteTagModalOpen}\r\n          currentTags={tags}\r\n          bucketName={bucketName}\r\n          onCloseAndUpdate={closeDeleteTagModal}\r\n          selectedTag={selectedTag}\r\n        />\r\n      )}\r\n    </Box>\r\n  );\r\n};\r\n\r\nexport default BucketTags;\r\n","\"use strict\";\n\nvar _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\");\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\n\nvar _createSvgIcon = _interopRequireDefault(require(\"./utils/createSvgIcon\"));\n\nvar _jsxRuntime = require(\"react/jsx-runtime\");\n\nvar _default = (0, _createSvgIcon.default)( /*#__PURE__*/(0, _jsxRuntime.jsx)(\"path\", {\n  d: \"M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6v2z\"\n}), 'Add');\n\nexports.default = _default;"],"names":["AddBucketTagModal","withSuspense","React","DeleteBucketTagModal","bucketName","dispatch","useAppDispatch","useState","tags","setTags","tagModalOpen","setTagModalOpen","tagKeys","setTagKeys","selectedTag","setSelectedTag","deleteTagModalOpen","setDeleteTagModalOpen","useApi","res","details","Object","keys","err","setErrorSnackMessage","isLoading","invokeTagsApi","fetchTags","useEffect","t","useTranslation","style","width","height","scopes","IAM_SCOPES","resource","sx","display","flexFlow","map","tagKey","index","tag","get","matchAll","errorProps","deleteIcon","onDelete","textTransform","marginRight","size","label","color","tagLabel","deleteTag","disabled","onClick","maxWidth","marginTop","icon","clickable","variant","modalOpen","currentTags","onCloseAndUpdate","refresh","deleteOpen","_interopRequireDefault","require","exports","_createSvgIcon","_jsxRuntime","_default","default","jsx","d"],"sourceRoot":""}