"use strict";(self.webpackChunkportal_ui=self.webpackChunkportal_ui||[]).push([[5367],{15367:function(e,t,n){n.r(t);var a=n(29439),i=n(1413),r=n(11135),o=n(25787),s=n(23814),l=n(72791),c=n(60364),u=n(25469),d=n(81207),m=n(16871),g=n(37516),h=n(61889),v=n(21435),p=n(51691),x=n(36151),f=n(2148),Z=n(87995),y=n(32509),C=n(56578),j=n(25693),b=n(84741),N=n(18158),A=n(1078),S=n(80184);t.default=(0,o.Z)((function(e){return(0,r.Z)((0,i.Z)((0,i.Z)((0,i.Z)((0,i.Z)((0,i.Z)((0,i.Z)((0,i.Z)({},s.oZ),s.bK),{},{bold:{fontWeight:"bold"},italic:{fontStyle:"italic"},fileItem:{marginRight:10,display:"flex","& div label":{minWidth:50},"@media (max-width: 900px)":{flexFlow:"column"}}},(0,s.Bz)(e.spacing(4))),s.QV),s.DF),s.oO),s.AK))}))((function(e){var t=e.classes,n=(0,u.TL)(),i=(0,m.UO)(),r=i.tenantName,o=i.tenantNamespace,s=(0,c.v9)((function(e){return e.editTenantMonitoring.prometheusEnabled})),R=(0,c.v9)((function(e){return e.editTenantMonitoring.image})),k=(0,c.v9)((function(e){return e.editTenantMonitoring.sidecarImage})),G=(0,c.v9)((function(e){return e.editTenantMonitoring.initImage})),P=(0,c.v9)((function(e){return e.editTenantMonitoring.diskCapacityGB})),I=(0,c.v9)((function(e){return e.editTenantMonitoring.monitoringCPURequest})),M=(0,c.v9)((function(e){return e.editTenantMonitoring.monitoringMemRequest})),q=(0,c.v9)((function(e){return e.editTenantMonitoring.serviceAccountName})),w=(0,c.v9)((function(e){return e.editTenantMonitoring.storageClassName})),T=(0,l.useState)({}),B=(0,a.Z)(T,2),U=B[0],F=B[1],_=(0,l.useState)(!1),z=(0,a.Z)(_,2),E=z[0],L=z[1],V=(0,l.useState)([{key:"",value:""}]),O=(0,a.Z)(V,2),D=O[0],X=O[1],K=(0,l.useState)([{key:"",value:""}]),$=(0,a.Z)(K,2),H=$[0],Q=$[1],W=(0,l.useState)([{key:"",value:""}]),J=(0,a.Z)(W,2),Y=J[0],ee=J[1],te=(0,l.useState)(!0),ne=(0,a.Z)(te,2),ae=ne[0],ie=ne[1],re=(0,l.useState)({}),oe=(0,a.Z)(re,2),se=oe[0],le=oe[1],ce=(0,l.useState)({}),ue=(0,a.Z)(ce,2),de=ue[0],me=ue[1],ge=(0,l.useState)({}),he=(0,a.Z)(ge,2),ve=he[0],pe=he[1],xe=(0,c.v9)((function(e){return e.editTenantMonitoring.runAsGroup})),fe=(0,c.v9)((function(e){return e.editTenantMonitoring.runAsUser})),Ze=(0,c.v9)((function(e){return e.editTenantMonitoring.fsGroup})),ye=(0,c.v9)((function(e){return e.editTenantMonitoring.runAsNonRoot})),Ce=(0,c.v9)((function(e){return e.editTenantSecurityContext.fsGroupChangePolicy})),je=function(e){F((0,b.he)(U,e))},be=function(e){for(var t=[],n=0;n<e.length;n++)""!==e[n].key&&t.push(e[n]);return t},Ne=function(){if(0!==Object.keys(U).length||0!==Object.keys(se).length||0!==Object.keys(de).length||0!==Object.keys(ve).length){return n((0,Z.Ih)({errorMessage:"Invalid entry",detailedError:""})),!1}return!0};(0,l.useEffect)((function(){ae&&d.Z.invoke("GET","/api/v1/namespaces/".concat(o||"","/tenants/").concat(r||"","/monitoring")).then((function(e){n((0,j.bX)(e.prometheusEnabled)),function(e){n((0,j.QL)(e.image)),n((0,j.Ct)(e.sidecarImage)),n((0,j.Xz)(e.initImage)),n((0,j.cj)(e.storageClassName)),n((0,j.Tg)(e.diskCapacityGB)),n((0,j.qX)(e.serviceAccountName)),n((0,j.AC)(e.monitoringCPURequest)),e.monitoringMemRequest?n((0,j.bZ)(Math.floor(parseInt(e.monitoringMemRequest,10)/1e9).toString())):n((0,j.bZ)("0")),null!=e.labels?X(e.labels):X([{key:"",value:""}]),null!=e.annotations?Q(e.annotations):Q([{key:"",value:""}]),null!=e.nodeSelector?ee(e.nodeSelector):ee([{key:"",value:""}]),n((0,j.Be)(e.securityContext.runAsGroup)),n((0,j.wT)(e.securityContext.runAsUser)),n((0,j.vM)(e.securityContext.runAsNonRoot)),n((0,j.FP)(e.securityContext.fsGroup))}(e),ie(!1)})).catch((function(e){n((0,Z.Ih)(e)),ie(!1)}))}),[ae]);return(0,S.jsxs)(l.Fragment,{children:[E&&(0,S.jsx)(f.Z,{isOpen:E,title:s?"Disable Prometheus monitoring for this tenant?":"Enable Prometheus monitoring for this tenant?",confirmText:s?"Disable":"Enable",cancelText:"Cancel",onClose:function(){return L(!1)},onConfirm:function(){var e={prometheusEnabled:s,toggle:!0};d.Z.invoke("PUT","/api/v1/namespaces/".concat(o,"/tenants/").concat(r,"/monitoring"),e).then((function(){n((0,j.bX)(!s)),ie(!0),L(!1),ie(!0)})).catch((function(e){n((0,Z.Ih)(e))}))},confirmationContent:(0,S.jsx)(p.Z,{children:s?" Current configuration will be lost, and defaults reset if reenabled.":"A small Prometheus server will be started per the configuration provided, which will collect the Prometheus metrics for your tenant."})}),(0,S.jsxs)(h.ZP,{container:!0,spacing:1,children:[(0,S.jsx)(h.ZP,{item:!0,xs:!0,children:(0,S.jsx)("h1",{className:t.sectionTitle,children:"Prometheus Monitoring "})}),(0,S.jsx)(h.ZP,{item:!0,xs:7,justifyContent:"end",textAlign:"right",children:(0,S.jsx)(g.Z,{label:"",indicatorLabels:["Enabled","Disabled"],checked:s,value:"tenant_monitoring",id:"tenant-monitoring",name:"tenant-monitoring",onChange:function(){L(!0)},description:""})}),(0,S.jsx)(h.ZP,{item:!0,xs:12,children:(0,S.jsx)("hr",{className:t.hrClass})})]}),s&&(0,S.jsxs)(l.Fragment,{children:[(0,S.jsx)(h.ZP,{item:!0,xs:12,paddingBottom:2,children:(0,S.jsx)(v.Z,{id:"prometheus_image",label:"Image",placeholder:"quay.io/prometheus/prometheus:latest",name:"image",value:R,onChange:function(e){e.target.validity.valid&&n((0,j.QL)(e.target.value)),je("image")},pattern:b.lN,error:U.image||""},"image")}),(0,S.jsx)(h.ZP,{item:!0,xs:12,paddingBottom:2,children:(0,S.jsx)(v.Z,{id:"sidecarImage",label:"Sidecar Image",placeholder:"library/alpine:latest",name:"sidecarImage",value:k,onChange:function(e){e.target.validity.valid&&n((0,j.Ct)(e.target.value)),je("sidecarImage")},pattern:b.lN,error:U.sidecarImage||""},"sidecarImage")}),(0,S.jsx)(h.ZP,{item:!0,xs:12,paddingBottom:2,children:(0,S.jsx)(v.Z,{id:"initImage",label:"Init Image",placeholder:"library/busybox:1.33.1",name:"initImage",value:G,onChange:function(e){e.target.validity.valid&&n((0,j.Xz)(e.target.value)),je("initImage")},pattern:b.lN,error:U.initImage||""},"initImage")}),(0,S.jsx)(h.ZP,{item:!0,xs:12,paddingBottom:2,children:(0,S.jsx)(v.Z,{id:"diskCapacityGB",label:"Disk Capacity",placeholder:"Disk Capacity",name:"diskCapacityGB",value:P,onChange:function(e){e.target.validity.valid&&n((0,j.Tg)(e.target.value)),je("diskCapacityGB")},pattern:b.ux,error:U.diskCapacityGB||"",overlayObject:(0,S.jsx)(C.Z,{id:"size-unit",onUnitChange:function(){},unitSelected:"Gi",unitsList:[{label:"Gi",value:"Gi"}],disabled:!0})},"diskCapacityGB")}),(0,S.jsx)(h.ZP,{item:!0,xs:12,paddingBottom:2,children:(0,S.jsx)(v.Z,{id:"cpuRequest",label:"CPU Request",placeholder:"CPU Request",name:"cpuRequest",value:I,pattern:b.ux,onChange:function(e){e.target.validity.valid&&n((0,j.AC)(e.target.value)),je("cpuRequest")},error:U.cpuRequest||""},"cpuRequest")}),(0,S.jsx)(h.ZP,{item:!0,xs:12,paddingBottom:2,children:(0,S.jsx)(v.Z,{id:"memRequest",label:"Memory Request",placeholder:"Memory request",name:"memRequest",value:M,onChange:function(e){e.target.validity.valid&&n((0,j.bZ)(e.target.value)),je("memRequest")},pattern:b.ux,error:U.memRequest||"",overlayObject:(0,S.jsx)(C.Z,{id:"size-unit",onUnitChange:function(){},unitSelected:"Gi",unitsList:[{label:"Gi",value:"Gi"}],disabled:!0})},"memRequest")}),(0,S.jsx)(h.ZP,{item:!0,xs:12,paddingBottom:2,children:(0,S.jsx)(v.Z,{id:"serviceAccountName",label:"Service Account",placeholder:"Service Account Name",name:"serviceAccountName",value:q,onChange:function(e){e.target.validity.valid&&n((0,j.qX)(e.target.value)),je("serviceAccountName")},pattern:"^[a-zA-Z0-9-.]{1,253}$",error:U.serviceAccountName||""},"serviceAccountName")}),(0,S.jsx)(h.ZP,{item:!0,xs:12,paddingBottom:2,children:(0,S.jsx)(v.Z,{id:"storageClassName",label:"Storage Class",placeholder:"Storage Class Name",name:"storageClassName",value:w,onChange:function(e){e.target.validity.valid&&n((0,j.cj)(e.target.value)),je("storageClassName")},pattern:"^[a-zA-Z0-9-.]{1,253}$",error:U.storageClassName||""},"storageClassName")}),null!==D&&(0,S.jsxs)(h.ZP,{item:!0,xs:12,className:t.formFieldRow,children:[(0,S.jsx)("span",{className:t.inputLabel,children:"Labels"}),(0,S.jsx)(y.Z,{newValues:D,setNewValues:X,paramName:"Labels",error:se,setError:le})]}),null!==H&&(0,S.jsxs)(h.ZP,{item:!0,xs:12,className:t.formFieldRow,children:[(0,S.jsx)("span",{className:t.inputLabel,children:"Annotations"}),(0,S.jsx)(y.Z,{newValues:H,setNewValues:Q,paramName:"Annotations",error:de,setError:me})]}),null!==Y&&(0,S.jsxs)(h.ZP,{item:!0,xs:12,className:t.formFieldRow,children:[(0,S.jsx)("span",{className:t.inputLabel,children:"Node Selector"}),(0,S.jsx)(y.Z,{newValues:Y,setNewValues:ee,paramName:"Node Selector",error:ve,setError:pe})]}),(0,S.jsx)(h.ZP,{item:!0,xs:12,className:t.formFieldRow,children:(0,S.jsx)(N.Z,{classes:t,runAsGroup:xe,runAsUser:fe,fsGroup:Ze,runAsNonRoot:ye,fsGroupChangePolicy:Ce,setFSGroup:function(e){return n((0,j.FP)(e))},setRunAsUser:function(e){return n((0,j.wT)(e))},setRunAsGroup:function(e){return n((0,j.Be)(e))},setRunAsNonRoot:function(e){return n((0,j.vM)(e))},setFSGroupChangePolicy:function(e){return n((0,A.rR)(e))}})}),(0,S.jsx)(h.ZP,{item:!0,xs:12,textAlign:"right",children:(0,S.jsx)(x.Z,{type:"submit",id:"submit_button",variant:"contained",color:"primary",disabled:!Ne(),onClick:function(){return function(){if(Ne()){var e={runAsGroup:null!=xe?xe:"0",runAsUser:null!=fe?fe:"0",fsGroup:null!=Ze?Ze:"0",runAsNonRoot:null==ye||ye};d.Z.invoke("PUT","/api/v1/namespaces/".concat(o,"/tenants/").concat(r,"/monitoring"),{labels:be(D),annotations:be(H),nodeSelector:be(Y),image:R,sidecarImage:k,initImage:G,diskCapacityGB:P,serviceAccountName:q,storageClassName:w,monitoringCPURequest:I,monitoringMemRequest:M+"Gi",securityContext:e}).then((function(){ie(!0),n((0,Z.y1)("Prometheus configuration updated."))})).catch((function(e){(0,Z.Ih)(e)}))}}()},children:"Save"})})]})]})}))},32509:function(e,t,n){var a=n(93433),i=n(1413),r=n(72791),o=n(11135),s=n(25787),l=n(23814),c=n(21435),u=n(20068),d=n(13400),m=n(42419),g=n(27247),h=n(40968),v=n(84741),p=n(61889),x=n(80184);t.Z=(0,s.Z)((function(e){return(0,o.Z)((0,i.Z)({bottomContainer:{display:"flex",flexGrow:1,alignItems:"center","& div":{flexGrow:1,width:"100%"}},shortened:{gridTemplateColumns:"auto auto 20px 20px",display:"grid",gridGap:20,paddingRight:20}},l.oO))}))((function(e){var t=e.classes,n=e.paramName,i=e.newValues,o=e.setNewValues,s=e.error,l=e.setError,f=function(e){l((0,v.he)(s,e))};(0,r.useEffect)((function(){for(var e=[],t=0;t<i.length;t++)e.push({fieldKey:"key-".concat(t.toString()),required:!1,value:i[t].key,pattern:/^[a-zA-Z0-9-_.]{1,63}$/,customPatternMessage:"Invalid key"}),e.push({fieldKey:"val-".concat(t.toString()),required:!1,value:i[t].value,pattern:/^[a-zA-Z0-9-_.]{1,63}$/,customPatternMessage:"Invalid value"});var n=(0,h.R)(e);l(n)}),[i,l]);var Z=i.map((function(e,l){return(0,x.jsx)(r.Fragment,{children:(0,x.jsx)(p.ZP,{paddingBottom:1,children:(0,x.jsxs)("div",{className:t.shortened,children:[(0,x.jsx)(c.Z,{id:"key-".concat(n.replace(/ /g,""),"-").concat(l.toString()),label:"",placeholder:"Key",name:"key-".concat(l.toString()),value:i[l].key,onChange:function(e){var t=(0,a.Z)(i);t[l].key=e.target.value,o(t),f("key-".concat(l.toString()))},index:l,error:s["key-".concat(l.toString())]||""},"csv-key-".concat(l.toString())),(0,x.jsx)(c.Z,{id:"val-".concat(n.replace(/ /g,""),"-").concat(l.toString()),label:"",placeholder:"Value",name:"val-".concat(l.toString()),value:i[l].value,onChange:function(e){var t=(0,a.Z)(i);t[l].value=e.target.value,o(t),f("val-".concat(l.toString()))},index:l,error:s["val-".concat(l.toString())]||""},"csv-val-".concat(l.toString())),(0,x.jsx)(u.Z,{title:"Add ".concat(n),"aria-label":"addlabel",children:(0,x.jsx)(d.Z,{id:"add-".concat(n.replace(/ /g,""),"-").concat(l.toString()),size:"small",onClick:function(){var e=(0,a.Z)(i);e.push({key:"",value:""}),o(e)},children:(0,x.jsx)(m.Z,{})})}),(0,x.jsx)(u.Z,{title:"Remove","aria-label":"removeLabel",children:(0,x.jsx)(d.Z,{id:"remove-".concat(n.replace(/ /g,""),"-").concat(l.toString()),size:"small",style:{marginLeft:16},onClick:function(){if(1===i.length&&o([{key:"",value:""}]),i.length>1){var e=(0,a.Z)(i);e.splice(l,1),o(e)}},children:(0,x.jsx)(g.Z,{})})})]})})},"keyvalue-".concat(l.toString()))}));return(0,x.jsx)(r.Fragment,{children:Z})}))},18158:function(e,t,n){var a=n(72791),i=n(21435),r=n(37516),o=n(90673),s=n(61889),l=n(60364),c=n(11135),u=n(25787),d=n(80184);t.Z=(0,u.Z)((function(e){return(0,c.Z)({configSectionItem:{marginRight:15,marginBottom:15,"& .multiContainer":{border:"1px solid red"}}})}))((function(e){var t=e.classes,n=e.runAsGroup,c=e.runAsUser,u=e.fsGroup,m=e.fsGroupChangePolicy,g=e.runAsNonRoot,h=e.setRunAsUser,v=e.setRunAsGroup,p=e.setFSGroup,x=e.setRunAsNonRoot,f=e.setFSGroupChangePolicy,Z=(0,l.I0)();return(0,d.jsx)(a.Fragment,{children:(0,d.jsxs)("fieldset",{className:"".concat(t.fieldGroup," ").concat(t.fieldSpaceTop," "),children:[(0,d.jsx)("legend",{className:t.descriptionText,children:"Security Context"}),(0,d.jsx)(s.ZP,{item:!0,xs:12,children:(0,d.jsxs)("div",{className:"".concat(t.multiContainerStackNarrow," "),children:[(0,d.jsx)("div",{className:t.configSectionItem,children:(0,d.jsx)(i.Z,{type:"number",id:"securityContext_runAsUser",name:"securityContext_runAsUser",onChange:function(e){Z(h(e.target.value))},label:"Run As User",value:c,required:!0,min:"0"})}),(0,d.jsx)("div",{className:t.configSectionItem,children:(0,d.jsx)(i.Z,{type:"number",id:"securityContext_runAsGroup",name:"securityContext_runAsGroup",onChange:function(e){Z(v(e.target.value))},label:"Run As Group",value:n,required:!0,min:"0"})})]})}),(0,d.jsx)(s.ZP,{item:!0,xs:12,children:(0,d.jsxs)("div",{className:"".concat(t.multiContainerStackNarrow," "),children:[(0,d.jsx)("div",{className:t.configSectionItem,children:(0,d.jsx)(i.Z,{type:"number",id:"securityContext_fsGroup",name:"securityContext_fsGroup",onChange:function(e){Z(p(e.target.value))},label:"FsGroup",value:u,required:!0,min:"0"})}),(0,d.jsx)("div",{className:t.configSectionItem,children:(0,d.jsx)(o.Z,{label:"FsGroupChangePolicy",id:"securityContext_fsGroupChangePolicy",name:"securityContext_fsGroupChangePolicy",onChange:function(e){Z(f(e.target.value))},value:m,options:[{label:"Always",value:"Always"},{label:"OnRootMismatch",value:"OnRootMismatch"}]})})]})}),(0,d.jsx)(s.ZP,{item:!0,xs:12,children:(0,d.jsx)("div",{className:t.multiContainer,children:(0,d.jsx)(r.Z,{value:"SecurityContextRunAsNonRoot",id:"securityContext_runAsNonRoot",name:"securityContext_runAsNonRoot",checked:g,onChange:function(){Z(x(!g))},label:"Do not run as Root"})})})]})})}))},42419:function(e,t,n){var a=n(95318);t.Z=void 0;var i=a(n(45649)),r=n(80184),o=(0,i.default)((0,r.jsx)("path",{d:"M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6v2z"}),"Add");t.Z=o},27247:function(e,t,n){var a=n(95318);t.Z=void 0;var i=a(n(45649)),r=n(80184),o=(0,i.default)((0,r.jsx)("path",{d:"M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6v12zM19 4h-3.5l-1-1h-5l-1 1H5v2h14V4z"}),"Delete");t.Z=o}}]);
//# sourceMappingURL=5367.4abbf09c.chunk.js.map